<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>每日多语言新闻</title>
    <style>
        body {font-family: "PingFang SC", sans-serif; margin: 20px; line-height: 1.6;}
        h1 {font-size: 24px;}
        .section {margin-bottom: 30px;}
    </style>
</head>
<body>
    <h1>今日新闻（示例）</h1>

    <div class="section">
        <h2>中文原文</h2>
        <p id="origin">正在加载……</p>
    </div>

    <div class="section">
        <h2>英语改写（300±20 字）</h2>
        <p id="en">正在加载……</p>
    </div>

    <div class="section">
        <h2>日语 / 法语 / 德语翻译</h2>
        <p id="ja">正在加载……</p>
        <p id="fr">正在加载……</p>
        <p id="de">正在加载……</p>
    </div>

    <script type="module">
import { GoogleGenerativeAI } from "https://esm.sh/@google/generative-ai";
const API_KEY = "你的密钥";
const genAI = new GoogleGenerativeAI(API_KEY);
const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash-latest" });

const news = "7月14日，巴黎奥运会开幕式进入最后一周倒计时，法国警方加强安保措施，确保约30万观众安全。";

async function run() {
  // 1) 原文 & 改写
  const prompt_en = `将下面中文新闻改写成英文，300±20字：\n${news}`;
  document.getElementById("origin").innerText = news;
  document.getElementById("en").innerText   = (await model.generateContent(prompt_en)).response.text();

  // 2) 三语翻译
  const [ja, fr, de] = await Promise.all([
    model.generateContent(`翻译成日语：\n${news}`),
    model.generateContent(`翻译成法语：\n${news}`),
    model.generateContent(`翻译成德语：\n${news}`)
  ]);
  document.getElementById("ja").innerText = ja.response.text();
  document.getElementById("fr").innerText = fr.response.text();
  document.getElementById("de").innerText = de.response.text();

  // 3) 5 个关键词汇卡片
  const prompt_vocab = `
从上面英文改写中，挑出 5 个对日语/法语/德语初学者来说较难的核心词汇。
为每个词给出：
- 原词
- 音标（英式 IPA）
- 英/日/法/德 四种语言释义
- 1 句简短例句
输出格式：每词占一行，用 | 分隔字段
`;
  const vocabRaw = (await model.generateContent(prompt_vocab)).response.text();
  const vocabLines = vocabRaw.trim().split('\n');
  let html = '';
  vocabLines.forEach(line => {
    const [word, ipa, ...rest] = line.split('|');
    html += `<div style="border:1px solid #ddd;margin:6px 0;padding:8px;">
      <strong>${word}</strong> ${ipa}<br>
      ${rest.join(' / ')}
    </div>`;
  });
  document.getElementById("vocab").innerHTML = html;

  // 4) 迷你语法点（各 1 句）
  const grammarPrompt = (lang) => `用中文解释下面英文句子中，一句最简单的${lang}语法现象：\n${document.getElementById("en").innerText}`;
  document.getElementById("grammar-ja").innerText = (await model.generateContent(grammarPrompt("日语"))).response.text();
  document.getElementById("grammar-fr").innerText = (await model.generateContent(grammarPrompt("法语"))).response.text();
  document.getElementById("grammar-de").innerText = (await model.generateContent(grammarPrompt("德语"))).response.text();
}

window.addEventListener('DOMContentLoaded', run);
</script>
    <!-- ===== Vocabulary Cards ===== -->
<div class="section">
  <h2>🔑 5 Key Words</h2>
  <div id="vocab"></div>
</div>

<!-- ===== Grammar Spotlight ===== -->
<div class="section">
  <h2>📚 Mini Grammar</h2>
  <p><strong>Japanese:</strong> <span id="grammar-ja"></span></p>
  <p><strong>French:</strong> <span id="grammar-fr"></span></p>
  <p><strong>German:</strong> <span id="grammar-de"></span></p>
</div>
</body>
</html>
